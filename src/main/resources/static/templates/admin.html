<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
    <script src="../bootstrap/js/bootstrap.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <link rel="stylesheet" href="../static/js/style.css">

</head>


<script>
	function sendCurrentEmail(e){
		var row = $(e).closest('tr').index();
		var currentEmail = document.getElementById("usertable").rows[row+1].cells[2].innerHTML;
		var req = new XMLHttpRequest();
    	var url = "http://localhost:8080/adminCurEmail?currentEmail=" + currentEmail;
    	req.open("GET", url, true);
    	req.send(null);
	}
</script>



<body class="bg-secondary">
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
			<a class="text-white navbar-brand toggle-btn" onclick="toggleNav()">&#9776;</a>
		<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
			<div class="navbar-nav">
				<a class="nav-item nav-link text-light" href="http://localhost:8080/">Home <span class="sr-only">(current)</span></a>
			</div>
		</div>

	</nav>

	<div class="container bg-light mt-3 rounded">
		<div class="container py-3">
			<h2 class=""> Manage Accounts </h2>

		</div>
		<div class="container">
			<button type="button" class="btn btn-outline-primary btn-sm mb-2" data-toggle="modal" data-target="#addModal">Add User</button>
			<button type="button" class="btn btn-outline-danger btn-sm mb-2" data-toggle="modal" data-target="#deleteModal">Delete</button>
		</div>

	<form action="http://localhost:8080/admin" method="GET">
		<div class="container bg-light pb-3">
			<table id="usertable" class="table table-striped table-hover table-bordered">
				<thead class="thead-light">
					<tr>
					<th scope="col">Username</th>
					<th scope="col">Password</th>
					<th scope="col">Email</th>
					<th scope="col">Actions</th>
					</tr>
	  			</thead>
				<tbody>
						<tr th:each="user : ${listOfUsers}">
						<td name="usernameRow" th:text="${user.getUsername()}"></td>
						<td name="passwordRow" th:text="${user.getPassword()}"></td>
						<td name="emailRow" th:text="${user.getEmail()}"></td>
						<td>
									<button type="button" class="btn btn-outline-info btn-primary btn-sm" data-toggle="modal" data-target="#editModal" onclick="sendCurrentEmail(this);">Edit</button>
								</td>
						</tr>
	  			</tbody>
			</table>
		</div>
	</form>




		<!-- Add Modal -->
		<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="addModalLabel">Add User</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form action="http://localhost:8080/adminAdd" method='POST'>
						<div class="modal-body">
							<div class='form-group'>
								<label>New Username</label>
								<input type='text' name='username' class='form-control' placeholder='Username'>
							</div>
							<div class='form-group'>
								<label>New Password</label>
								<input type='password' name='password' class='form-control' placeholder='Password'>
							</div>
							<div class='form-group'>
								<label>New Email</label>
								<input type='text' name='email' class='form-control' placeholder='Email'>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
							<input type="submit" class="btn btn-primary" value="Save changes"/>
						</div>
					</form>
				</div>
			</div>
		</div>




			<!-- Edit Modal -->
			<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h5 class="modal-title" id="exampleModalLabel">Edit User</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          <span aria-hidden="true">&times;</span>
			        </button>
			      </div>
				<form action="http://localhost:8080/adminEdit" method='POST'>
			      <div class="modal-body">
									<div class='form-group'>
										<label>New Username</label>
										<input type='text' name='username' class='form-control' placeholder='Username'>
									</div>
									<div class='form-group'>
										<label>New Password</label>
										<input type='password' name='password' class='form-control' placeholder='Password'>
									</div>
									  <div class='form-group'>
										  <label>New Email</label>
										  <input type='text' name='email' class='form-control' placeholder='Email'>
									  </div>
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			        <input type="submit" class="btn btn-primary" value="Save changes"/>
			      </div>
				</form>
			    </div>
			  </div>
			</div>



		<!-- Delete Modal -->
		<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="deleteModalLabel">Add User</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form action="http://localhost:8080/adminDelete" method='POST'>
						<div class="modal-body">
							<div class='form-group'>
								<label>Email of Account to Remove</label>
								<input type='text' name='email' class='form-control' placeholder='Email'>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
							<input type="submit" class="btn btn-primary" value="Delete"/>
						</div>
					</form>
				</div>
			</div>
		</div>


		</div>
	</div>

</body>

</html>
